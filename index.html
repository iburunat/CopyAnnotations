<html>

<head>
  <link rel="stylesheet" href="https://jonudell.info/hlib/hlib.css">
  <style>
    body {
      display: flex;
      margin-top: 20px;
    }

    h1 {
      font-size: 14pt;
    }

    #viewer {
      width: 40%;
      margin-left: 20px;
    }

    #urlList {
      width: 50%;
      margin-left: 40px;
      margin-top: 20px;
    }
    .progress {
      display: none;
    }
  </style>
</head>

<body>

  <div id="formContainer">

    <h1>
     Copy Hypothesis annotations from one domain (and/or group) to another
    </h1>

    <div class="formField" id="userContainer"></div>
    <div class="formField" id="tokenContainer"></div>
    <div class="formField" id="sourceDomainContainer"></div>
    <div class="formField" id="destinationDomainContainer"></div>
    <div class="formField" id="sourceGroupContainer"></div>
    <div class="formField" id="destinationGroupContainer"></div>
    <div class="formField" id="limitContainer"></div>
    <div class="formField" id="userFilterContainer"></div>
    
    <div><button onclick="copy()">copy</button></div>
    <div class="progress"><span class="counter">0</span> of <span class="total">0</span></div>

    <div class="help">
      <hr>
      <p>
        This tool copies annotations from one domain to another. 
        Until we can search whole domains, you'll need to provide a list of URLs 
        that we'll search one by one. 
        Only top-level annotations will be copied, replies are ignored.
        The Hypothesis username you provide will be the creator of copied annotations.
        If the source group is not Public, the Hypothesis user must be a member to 
        read annotations from it. Likewise, if the destination group is not Public, 
        the Hypothesis user must be a member to write annotations to it.
      </p>
    </div>

  </div>

  <div id="urlList">
      <!--<textarea id="urlListContainer" rows="40" cols="80">http://jonudell.net/h/test-chapter1.html</textarea>-->
    <textarea rows="40" cols="80" id="urlListContainer">Paste URLs here, one per line.

This tool expects that all the URLs live at the same source domain, e.g. https://originalBook.org.

It expects you to provide a destination domain which may be the same (e.g. https://originalBook.org) or different (e.g. https://revisedBook.net).

For each URL, the tool searches for annotations in the sourceGroup you picked, and copies annotations to the destinationDomain, placing them in the destinationGroup you picked.
  
The sourceGroup and destinationGroup can be the same or different.

Suppose sourceGroup and destinationGroup are both Public in both cases, and your source URLs are:  

https://originalBook.org/chapter1.html
https://originalBook.org/chapter2.html

If your destinationDomain is https://revisedBook.net, then the annotations from those two chapters, in group Public, will be copied to group Public at:

https://revisedBook.org/chapter1.html
https://revisedBook.org/chapter2.html

Copied annotations will be owned by the user whose username and API token you specify.

Copied annotations will include a note that cites the original user, the original date, and the copy date.

To proceed, replace all the text here with a list of URLs, one per line.
    </textarea>
  </div>
  
  <div id="viewer"></div>

  <script src="https://jonudell.info/hlib/hlib.bundle.js"></script>
  <script src="./index.js"></script>

</body>

</html>